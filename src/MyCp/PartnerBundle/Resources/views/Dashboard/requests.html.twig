{% set formFilter = form_search_requests.createView() %}
<div class="ibox card">
    <div class="ibox-title card">
        <div class="title-card">{{ "dashboard.requests.pending" | trans }}</div>

        <div class="ibox-tools">
            <a class="collapse-link">
                <i class="fa fa-chevron-up"></i>
            </a>
            {#<a class="dropdown-toggle" data-toggle="dropdown" href="#">
                <i class="fa fa-wrench"></i>
            </a>
            <ul class="dropdown-menu dropdown-user">
                <li><a href="#">Config option 1</a>
                </li>
                <li><a href="#">Config option 2</a>
                </li>
            </ul>#}
            <a class="close-link">
                <i class="fa fa-times"></i>
            </a>
        </div>
    </div>
    <div class="ibox-content card">
        <form id="filter_form" class="filter-form">
            <div class="row">
                <div class="col-lg-1 field-filter">
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon fa-letter">CAS</span>
                            {{ form_widget(formFilter.code, { 'attr': {'placeholder': 'requests.placeholder.code'|trans, 'title':'requests.title.code'|trans, 'data-toggle':'tooltip', 'data-container':'body', 'class':'form-control' }}) }}
                        </div>
                    </div>
                </div>
                <div class="col-lg-2 field-filter">
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-facebook-square"></i></span>
                            {{ form_widget(formFilter.name, { 'attr': {'placeholder': 'requests.placeholder.name'|trans, 'title':'requests.title.name'|trans, 'data-toggle':'tooltip', 'data-container':'body', 'class':'form-control' }}) }}
                        </div>
                    </div>
                </div>
                <div class="col-lg-1 field-filter">
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-facebook-square"></i></span>
                            {{ form_widget(formFilter.accommodation, { 'attr': {'placeholder': 'requests.placeholder.accommodation'|trans, 'title':'requests.title.accommodation'|trans, 'data-toggle':'tooltip', 'data-container':'body', 'class':'form-control' }}) }}
                        </div>
                    </div>
                </div>
                <div class="col-lg-2 field-filter">
                    <div class="form-group">
                        <div class="input-group date">
                            {{ form_widget(formFilter.arrival, { 'attr': {'placeholder': 'requests.placeholder.arrival'|trans, 'title':'requests.title.arrival'|trans, 'data-toggle':'tooltip', 'data-container':'body', 'class':'form-control' }}) }}
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2 field-filter">
                    <div class="form-group">
                        <div class="input-group date">
                            {{ form_widget(formFilter.exit, { 'attr': {'placeholder': 'requests.placeholder.exit'|trans, 'title':'requests.title.exit'|trans, 'data-toggle':'tooltip', 'data-container':'body', 'class':'form-control' }}) }}
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2 field-filter">
                    <div class="form-group">
                        {{ form_widget(formFilter.destination, { 'attr': {'data-placeholder': 'requests.placeholder.destination'|trans, 'title':'requests.title.destination'|trans, 'data-toggle':'tooltip', 'data-container':'body', 'class':'form-control chosen-select-deselect' }}) }}
                    </div>
                </div>
                <div class="col-lg-2 field-filter">
                    <div class="form-group">
                        <div class="input-group date">
                            {{ form_widget(formFilter.request, { 'attr': {'placeholder': 'requests.placeholder.request'|trans, 'title':'requests.title.request'|trans, 'data-toggle':'tooltip', 'data-container':'body', 'class':'form-control' }}) }}
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-xs-4"></div>
                <div class="col-xs-4"></div>
                <div class="col-xs-4 field-filter">
                    <div class="btn-group pull-right m-t-n-xs"><a class="btn btn-sm btn-search" onClick="filterActionBussiness(this)"> {{ 'btn.filter' | trans }} </a></div>
                    <div class="btn-group pull-right m-t-n-xs" style="margin-right: 4px"><a class="btn btn-sm btn-search" onClick="filterActionBussiness(this)"> {{ 'btn.filter' | trans }} </a></div>
                </div>
            </div>
        </form>

        <div class="row" style="margin-top: 10px">
            <div class="col-sm-12" style="padding-left: 4px; padding-right: 4px;">
                <div class="ibox float-e-margins">
                    <div class="ibox-content">
                        <div class="table-responsive">
                            <table id="table-requests" class="table table-striped table-bordered table-hover  dataTable " role="grid" aria-describedby="editable_info">
                                <thead>
                                <tr role="row">
                                    <th>{{ 'requests.title.name' | trans }}</th>
                                </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        var oTable = '';
        $(document).ready(function () {
            oTable = $('#table-requests').DataTable({
                bFilter: false,//true: Para sustituirlo por el add user
                "bLengthChange": false,
                "scrollX": false,
                "ajax": {
                    "url": "{{ path('partner_dashboard_requests_list') }}",
                    data: function (params) {
                        var inputs = $("#filter_form input,select");
                        inputs.each(function () {
                            var input = $(this);
                            var val = input.val();
                            var name = input.attr('name');
                            if (val && val != '' && name && name != '') {
                                params[input.attr('name')] = val;
                            }
                        });
                    }
                },
                "aoColumnDefs": [
                    {
                        "orderable": false,
                        "mData": null,
                        "aTargets": [0],
                        "mRender": function (data, type, full) {
                            var html = '<div class="row"> ' +
                                    '<div class="col-xs-12"> <em class="rt">CAS:</em> <span class="rst">' + data.code + '</span> <em class="rt">Llegada:</em> ' + data.arrival + ' <em class="rt">Salida:</em> ' + data.exit + ' <em class="rt">Casa:</em> ' + data.name + ' <em class="rt">Cliente:</em> ' + data.client + ' <em class="rt">Habitaci√≥n:</em> ' + data.room + ' <em class="rt">Precio/noche:</em> ' + data.price + ' </div> ' +
                                    '<div class="col-xs-12"> <em class="rt">Prepago:</em> ' + data.payment + ' </div> </div>';
                            return html;
                        }
                    }
                ],
                "columns": [
                    {"data": 'data'}
                ],
                fnDrawCallback: function() {
                    $("#table-requests thead").remove();
                }
            });
        });
    });
</script>