{% extends 'LayoutBundle:Layout:layout_partner.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
{% endblock %}
{% block login_register %}
    {% include 'LayoutBundle:Security:overlay_login.html.twig' %}
    {% include 'LayoutBundle:Security:overlay_register.html.twig' %}
{% endblock %}
{% block body %}
    {#-----Section win-----#}
    {{ include('PartnerBundle:Section:win-partner.html.twig') }}
    {#-----Section package-----#}
    {{ include('PartnerBundle:Section:package-partner.html.twig') }}
    {#-----Section offer-----#}
    {{ include('PartnerBundle:Section:offer-partner.html.twig') }}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
        $(function () {

            {% if remoteLogin is defined %}
            {% if type_login is defined %}
            {% set currentPath = path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')) %}
                var currentPath = '{{ currentPath }}';
            {% else %}
            var currentPath = '{{ app.request.headers.get('referer') }}';
            {% endif %}

            function initLoginOverlay(){
                var b = $("#login-overlay");
                b.one('click', function () {
                    HoldOn.open();
                    var overlay = $(b.data('overlay'));
                    var xpath ='{{ path('frontend_partner_logincontent') }}';
                    var params = {action:1};
                    overlay.load(xpath, params, function (e) {
                        HoldOn.close();
                        $("#login-overlay").pageOverlay();
                        $("#login-overlay").click();
                        initRegisterOverlay();
                        $('input[name="_target_path"]').val(currentPath);
                    });
                });
            }

            function initRegisterOverlay(){
                var b = $("#trigger-overlay-register");
                b.one('click', function () {
                    HoldOn.open();
                    var overlay = $(b.data('overlay'));
                    var xpath ='{{ path('frontend_partner_registercontent') }}';
                    var params = {action:1};
                    overlay.load(xpath, params, function (e) {
                        HoldOn.close();
                        $("#trigger-overlay-register").pageOverlay();
                        $("#trigger-overlay-register").click();
                    });
                });
            }

            initLoginOverlay();
            {% else %}
                $("#login-overlay").pageOverlay();
                $("#trigger-overlay-register").pageOverlay();
            {% endif %}

        });
    </script>
    <script>

        $(document).ready(function () {

            $('body').scrollspy({
                target: '.navbar-fixed-top',
                offset: 80
            });

            // Page scrolling feature
            $('a.page-scroll').bind('click', function(event) {
                var link = $(this);
                $('html, body').stop().animate({
                    scrollTop: $(link.attr('href')).offset().top - 50
                }, 500);
                event.preventDefault();
            });
        });

        var cbpAnimatedHeader = (function() {
            var docElem = document.documentElement,
                    header = document.querySelector( '.navbar-default' ),
                    didScroll = false,
                    changeHeaderOn = 200;
            function init() {
                window.addEventListener( 'scroll', function( event ) {
                    if( !didScroll ) {
                        didScroll = true;
                        setTimeout( scrollPage, 250 );
                    }
                }, false );
            }
            function scrollPage() {
                var sy = scrollY();
                if ( sy >= changeHeaderOn ) {
                    $(header).addClass('navbar-scroll')
                }
                else {
                    $(header).removeClass('navbar-scroll')
                }
                didScroll = false;
            }
            function scrollY() {
                return window.pageYOffset || docElem.scrollTop;
            }
            init();

        })();

        // Activate WOW.js plugin for animation on scrol
        new WOW().init();

    </script>
{% endblock %}


