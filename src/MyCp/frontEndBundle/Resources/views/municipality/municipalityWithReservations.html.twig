{% extends 'frontEndBundle:layout:base.html.twig' %}
{% block title %}
{{"MOST_VISITED_CITIES"  | trans }}
{% endblock %}

{% set main_tab = 2 %}
{% block content_nav_top_body %}
destinos
{% endblock %}

{% block body %}
<ul class="breadcrumb">
    <li><a href="{{ path('frontend_welcome') }}" title="{{"GO_HOME_TITLE" | trans}}">{{"HOME_MAIN_MENU" | trans}}</a> <span class="divider">»</span></li>
    <li class="active">{{"DESTINATIONS_MAIN_MENU" | trans}}<span class="divider">»</span></li>
    <li class="active">{{"MOST_VISITED_CITIES" | trans}}</li>
</ul>
<div class="row-fluid filter_1">
</div>
<div id="loading" class="alert alert-info hidden"> <img src="{{ asset('bundles/frontend/img/loading.gif') }}"/> {{"LOADING_MESSAGE" | trans}}</div>

<div class="row-fluid result_list ownerships_list" id="div_result">
   {%for item in list%}
   <div class="item">
    <div class="row-fluid">
    <div class="row-fluid">
        <div class="span10"> <h4>{{item['municipality']}}</h4> </div>
        <div class="span2">{{"VISITS" | trans}} {{item['reservation_total']}}</div>
    </div>
    <div class="row-fluid link_list">        
        <h6>{{"OWNERSHIPS" | trans}} ({{"TOTAL" | trans}}: {{item['owns_total']}})</h6>
        {%set owns_count = 1%}
        {%for own in item['owns_list']%}
        <a title="{{'MORE_INFO_PREFFIX' | trans}} {{own.ownname}}" href="{{ path('frontend_details_ownership',{'own_name':own.ownname  | lower | replace(' ','_')}) }}">{{own.ownName}}</a>
        {%if owns_count != item['owns_list']|length%}, {%endif%} 
        {%set owns_count = owns_count + 1%}
        {%endfor%}
        {%if item['owns_total'] > item['owns_list']|length%}
        ... <a href="{{ path('frontend_search_ownership',{'text':item['municipality'], 'arrival':'null','departure':'null','guests':'1', 'rooms':'1'}) }}" title="Ver mas en {{item['municipality']}}">(ver +)</a>
        {%endif%}
    </div>
        {%if item['des_total'] > 0%}
        <div class="row-fluid link_list">    
        <h6>{{"DESTINATIONS" | trans}} ({{"TOTAL" | trans}}: {{item['des_total']}})</h6>
        {%set des_count = 1%}
        {%for des in item['des_list']%}
        <a title="{{"MORE_INFO_PREFFIX" | trans}} {{des.deslocdestination.desName}}" href="{{ path('frontend_details_destination',{'destination_name':des.deslocdestination.desName|lower|replace(' ','_')}) }}">{{des.deslocdestination.desName}}</a>
        {%if des_count != item['des_list']|length%}, {%endif%} 
        {%set des_count = des_count + 1%}
        {%endfor%}
        {%if item['des_total'] > item['des_list']|length%}
        ... <a href="{{path('frontend_filter_by_municipality_destinations',{'municipality_id':item['municipality'].munid, 'province_id': item['municipality'].MunProvId.provid})}}" title="Ver mas en {{item['municipality']}}">{{"SEEMORE_LINK_TEXT" | trans}}</a>
        {%endif%}
    </div>
        {%endif%}
    </div>
</div>
{%else%}
<div class="noData">{{"EMPTY_LIST" | trans}}</div>
{%endfor%}
{%if list | length  and total_items > items_per_page%}
<div class="paginator-cont top_margin">
    {{ simple_paginator_render('frontend_get_with_reservations_municipality',null,{
    'container_class': 'paginator',
    'previousPageText': '«',
    'nextPageText': '»',
    'currentClass': 'current',
    'firstPageText': 'FIRST_PAGE' | trans,
    'lastPageText': 'LAST_PAGE' | trans,
    'route_params': null
}) }}
</div>
{%endif%}
</div>
 {% block include_javascripts %}
      
{% endblock %}
{% endblock %}
