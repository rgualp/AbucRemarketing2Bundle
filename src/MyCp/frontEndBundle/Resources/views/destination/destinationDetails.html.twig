{% extends 'frontEndBundle:layout:base.html.twig' %}
{% block title %}
{{destination.desname}}
{% endblock %}

{% set main_tab = 2 %}
{% block content_nav_top_body %}
<h4>{{destination.desName}}</h4>
<label class="place">{{location}}</label>
{% endblock %}

{% block body %}
<ul class="breadcrumb">
    <li><a href="{{ path('frontend_welcome') }}"  title="{{"GO_HOME_TITLE" | trans}}" >{{"HOME_MAIN_MENU" | trans}}</a> <span class="divider">Â»</span></li>
    <li class="active"><a href="{{ path('frontend_list_destinations') }}"  title="{{"GO_DESTINATION_TITLE" | trans}}" >{{"DESTINATIONS_MAIN_MENU" | trans}}</a></li>
</ul>
<div class="row-fluid">
    <div class="span3 menu_left">
        {%if destination.desgeolocatex != null and destination.desgeolocatey != null%}
            <div class="thumbnail" style="padding: 12px">
        <div id="big_map_details" class="google-maps" style="width:100%;height: 150px;"
    data-x="{{destination.desgeolocatex}}"
    data-y="{{destination.desgeolocatey}}"
    data-name="{{destination.desName}}"
    data-description="{{brief_description | striptags}}"
    data-image="{{asset('uploads/destinationImages/thumbnails/'~((gallery_photos[0] is defined) ? gallery_photos[0] : "no_photo.png"))}}"
    data-icon="http://www.mycasaparticular.com/web/bundles/frontend/images/map.png">
</div>
            </div>
        {%endif%}
        
        {{ include('frontEndBundle:ownership:verticalSearcherOwnership.html.twig',
        {'is_within_search_results':false, 
        'autocomplete_text_list': autocomplete_text_list, 
        'locale': locale})}}

        <div class="accordion accordion_destinations" id="accordion_destinations">
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion_destinations" href="#popular_destinations">{{"POPULAR_DESTINATIONS_HOME_TABS" | trans}}</a>
                </div>
                <div id="popular_destinations" class="accordion-body in collapse" style="height: auto;">
                    <div class="accordion-inner">
                        {%for destination in popular_list%}
                        <div class="item row-fluid">
                           <a title="{{"MORE_INFO_PREFFIX" | trans}} {{destination['des_name']}}" href="{{ path('frontend_details_destination',{'destination_name':destination['des_name']|lower|replace(' ','_')}) }}">{{destination['des_name']}}</a>
                         </div>
                        {%else%}
                        <div class="alert a alert-info">{{"EMPTY_LIST" | trans}}</div>
                        {%endfor%}
                        {%if popular_list |length%}
                        <div class="row-fluid textaling_right">
                            <div class="span2 offset9">
                                <a  class="fontsize_10" href="{{path('frontend_list_destinations')}}">{{"SEEMORE_LINK_TEXT" | trans}}</a>
                            </div>                            
                        </div>
                        {%endif%}
                    </div>
                </div>
            </div>
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion_destinations" href="#destinations_municipality">
                        {{"MORE_IN_DETAILS" | trans}} {{location_municipality}}
                    </a>                       
                </div>
                <div id="destinations_municipality" class="accordion-body collapse" style="height: 0px;">
                    <div class="accordion-inner">
                        {%for destination in other_destinations_in_municipality%}
                        <div class="item row-fluid">
                          <a title="{{"MORE_INFO_PREFFIX" | trans}} {{destination.desname}}" href="{{ path('frontend_details_destination',{'destination_name':destination.desname|lower|replace(' ','_')}) }}">{{destination.desname}}</a>
                        </div>
                        {%else%}
                        <div class="alert a alert-info">{{"EMPTY_LIST" | trans}}</div>
                        {%endfor%}
                        {%if other_destinations_in_municipality |length%}
                        <!--div class="row-fluid textaling_right">
                             <div class="span2 offset9">
                            <a  class="fontsize_10" href="{{path('frontend_filter_by_municipality_destinations',{'province_id': location_province_id, 'municipality_id':location_municipality_id})}}">{{"SEEMORE_LINK_TEXT" | trans}}</a>
                             </div>
                        </div-->
                        {%endif%}
                    </div>
                </div>
            </div>

            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion_destinations" href="#destinations_province">{{"MORE_IN_DETAILS" | trans}} {{location_province}}</a>
                </div>
                <div id="destinations_province" class="accordion-body collapse">
                    <div class="accordion-inner">
                        {%for destination in other_destinations_in_province%}
                        <div class="item row-fluid">
                           <a title="{{"MORE_INFO_PREFFIX" | trans}} {{destination.desname}}" href="{{ path('frontend_details_destination',{'destination_name':destination.desname|lower|replace(' ','_')}) }}">{{destination.desname}}</a>
                        </div>
                        {%else%}
                        <div class="alert a alert-info">{{"EMPTY_LIST" | trans}}</div>
                        {%endfor%}
                        {%if other_destinations_in_province |length%}
                        <!--div class="row-fluid textaling_right">
                             <div class="span2 offset9">
                            <a  class="fontsize_10" href="{{path('frontend_filter_by_province_destinations',{'province_id': location_province_id})}}">{{"SEEMORE_LINK_TEXT" | trans}}</a>
                             </div>
                        </div-->
                        {%endif%}
                    </div>
                </div>
            </div>

            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion_destinations" href="#destinations_all_provinces">
                        {{"ALL_PROVINCES" | trans}}
                    </a>                       
                </div>
                <div id="destinations_all_provinces" class="accordion-body collapse" style="height: 0px;">
                    <div class="accordion-inner">
                        {%for province in provinces%}
                    <div class="item row-fluid">
                        <a href="{{ path('frontend_search_ownership',{'text':province.provName, 'arrival':'null','departure':'null','guests':'1', 'rooms':'1'}) }}" title="{{province.provName}}">{{province.provName}}</a>
                    </div>    
                 {%endfor%}
                    </div>
                </div>
            </div>
        </div>
        
            <div class="tiny_font thumbnail favorites_details" style="padding: 12px;">
            {{ include('frontEndBundle:favorite:detailsFavorite.html.twig',
            {'is_in_favorite': is_in_favorite,
            'favorite_type': 'destination',
            'element_id':destination.desid
            }) }}
        </div>
        <div class="thumbnail" style="padding: 12px">
        <a href="#send_to_friend_popup" title="{{'SEND_TO_FRIEND' | trans}}" data-toggle="modal" style="text-decoration: none">
            <button style="font-size: 12px" class="btn btn-block" onclick="$('#send_to_friend_popup').attr('data-email-type', 'recommend_destiny'); $('#send_to_friend_popup').attr('data-dest-prop-id', '{{destination.getDesId}}');">
                <img src="{{ asset('bundles/frontend/images/main_to_friend.gif') }}">{{"TELL_A_FRIEND" | trans}}
            </button>
        </a>
    </div>
    </div>
    <div class="span9">
        <div class="row-fluid">
            {%if gallery_photos | length%}
            <div class="span7" style="margin-left:0px;">                
                <div id="photos" class="tab-pane fade in active">
                    <div id="gallery-1" class="royalSlider rsDefault">
                        {% for photo in  gallery_photos%}
                        <a class="rsImg" data-rsbigimg="{{asset('uploads/destinationImages/'~photo)}}"
                           href="{{asset('uploads/destinationImages/'~photo)}}"><img class="rsTmb"
                                                                                  src="{{asset('uploads/destinationImages/thumbnails/'~photo)}}"
                                                                                  width="60"></a>
                        {% endfor %}
                    </div>
                </div>        
            </div>
            {%if description | length > 0%}
            <div class="span5 destination_description_container pull-right" style="margin-left:5px; font-size: 12px; text-align: justify; padding: 10px">
                <div class="destination_description">
                    <h4>{{destination.desName}}</h4>                
                    {{description | raw}}
                </div>   
            </div> 
            {%endif%}
            {%else%}
            {%if description | length > 0%}
            <div class="destination_description_container">
                <div class="destination_description">
                    <h4>{{destination.desName}}</h4> 
                    {{description | raw}}
                </div>
            </div>
            {%endif%}
            {% endif %}
        </div>

            <div class="row-fluid" id="nav_blue_placeholder" data-url="{{path('frontend_nearby_destination',{'destination_name': destination.desname | lower | replace(" ", "_"),'destination_id': destination.desid })}}">
            {#% render "frontEndBundle:destination:owns_nearby_callback" with {'destination_name': destination.desname | lower | replace(" ", "_"),'destination_id': destination.desid }%#}
            {{include('frontEndBundle:destination:detailsOwnsNearByDestination.html.twig', {'owns_nearby': owns_nearby,'destination_name': destination.desname | lower | replace(" ", "_"),'destination_id': destination.desid })}}
        </div>
    </div>
</div>
{%render "frontEndBundle:user:info_tab_user" with {'destination_id': destination.desid }%}
{% block include_javascripts %}
<script src="{{ global_google_maps_api_url_with_key }}" type="text/javascript"></script>
<script src="{{ asset('bundles/frontend/js/jquery/jquery.ui.map.js') }}"></script>
<script src="{{ asset('bundles/frontend/js/jquery/jquery.ui.map.infobox.js') }}"></script>
<!--script src="{{ asset('bundles/frontend/js/home_search.js') }}"></script-->
<script src="{{ asset('bundles/frontend/js/destination_details.js') }}"></script>
<link href="{{ asset('bundles/frontend/css/bootstrap/bootstrap-datepicker.css') }}" rel="stylesheet" media="screen">
<script src="{{ asset('bundles/frontend/js/bootstrap/bootstrap-datepicker.js') }}"></script>
<script src="{{ asset('bundles/frontend/js/bootstrap/bootstrap-datepicker.es.js') }}"></script>
<script src="{{ asset('bundles/frontend/js/royal_slider/jquery.royalslider.min.js') }}"></script>
<link href="{{ asset('bundles/frontend/css/royal_slider/royalslider.css') }}" rel="stylesheet"/>
<link href="{{ asset('bundles/frontend/css/royal_slider/rs-default.css') }}" rel="stylesheet"/>
<script type="text/javascript">
    jQuery(document).ready(function () {
        $('#gallery-1').royalSlider({
            fullscreen:{
                enabled:true,
                nativeFS:true
            },
            controlNavigation:'thumbnails',
            autoScaleSlider:true,
            autoScaleSliderWidth:960,
            autoScaleSliderHeight:850,
            loop:false,
            imageScaleMode:'fit-if-smaller',
            navigateByClick:true,
            numImagesToPreload:2,
            arrowsNav:true,
            arrowsNavAutoHide:true,
            arrowsNavHideOnTouch:true,
            keyboardNavEnabled:true,
            fadeinLoadedSlide:true,
            globalCaption:true,
            globalCaptionInside:false,
            thumbs:{
                appendSpan:true,
                firstMargin:true,
                paddingBottom:4
            }
        });
    });
</script>
{% endblock %}
{% endblock %}