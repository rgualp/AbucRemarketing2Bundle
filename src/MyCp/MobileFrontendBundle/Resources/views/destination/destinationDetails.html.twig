{% extends 'FrontEndBundle:layout:base.html.twig' %}

{% set desName = (destination.desName | trans) %}
{% block title %}
    {{ 'DESTINATION_DETAILS' | trans ({'%destinationName%': desName}) }}
{% endblock %}

{% set section = constant('\\MyCp\\mycpBundle\\Entity\\metaTag::SECTION_DESTINATIONS') %}
{% set lang_code=app.session.get('app_lang_code')|lower %}
{% block metas %}
    {{ get_metas('Destino ' ~ destination.desName, lang_code)|raw }}
    {#{%if keyword_description != "" and keyword != ""%}
    <meta name="description" content="{{keyword_description}}">
    <meta name="keywords" content="{{keyword}}">
    {%else%}
    {{parent()}}
    {%endif%}#}
{% endblock %}

{% block include_javascripts_and_css %}
    <link href="{{ asset('bundles/frontend/css/filtersv2.css') }}" rel="stylesheet">

{% endblock %}
{% set main_tab = 2 %}
{% block breadcrumbs %}
    <a href="{{ path('frontend_welcome') }}" title="{{ "HOMEPAGE_TITLE" | trans }}">{{ "HOME_MAIN_MENU" | trans }}</a>
    <span>››</span>
    <a href="{{ path('frontend_list_destinations') }}" title="{{ "DESTINATIONS" | trans }}">{{ "DESTINATIONS" | trans }}</a>
    <span>››</span>
    <a href="#" class="active" title="{{ destination.desname }}">{{ destination.desname }}</a>
{% endblock %}
{% block body %}
    <div class="container cont-form" style="margin-top: -20px">
        <div id="main-search-2">
            {{ render(controller('FrontEndBundle:Ownership:orangeSearchBar')) }}
        </div>
    </div>
    <div class="container">
        <div>&nbsp;</div>
        <div class="row">
            {% if gallery_photos | length %}
                <div class="col-sm-12">
                    <div id="shadow_bottom" style="position: absolute; left: 15px; right: 30px; height: 0; bottom: 0; z-index: 23;
            -webkit-transition: all 0.6s ease;
             transition: all 0.6s ease;
            background: rgba(0,0,0,0);
            background: -moz-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%);
            background: -webkit-gradient(left top, left bottom, color-stop(0%, rgba(0,0,0,0)), color-stop(100%, rgba(0,0,0,1)));
            background: -webkit-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%);
            background: -o-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%);
            background: -ms-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%);
            background: linear-gradient(to bottom, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 100%);
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#000000', endColorstr='#000000', GradientType=0 );
            "></div>
                    <div id="description_cont" style="
            background-color: #000000; position: absolute; z-index: 22; top: 0; left: 15px; right: 15px;
            padding: 8px 60px 30px;
            background: #333333;
            background: rgba(0, 0, 0, 0.5);
             color: #ffffff; overflow: hidden;
             height: 54px;
             -webkit-transition: all 0.6s ease;
             transition: all 0.6s ease;
            ">
                        <div class="row">
                            <div class="col-xs-5"><h1 class="caecilia-roman no-margin h-size-2">{{ desName }}</h1></div>
                            <div class="col-xs-1 text-center"><em id="description_arrow" class="icon-chevron-down" style="margin-top: 10px; cursor: pointer;display:block"></em></div>
                        </div>

                        <p style="margin: 20px 0; font-size: 14px; line-height: 24px; ">{{ description | raw }}</p>
                    </div>
                    <div id="full-width-slider" class="royalSlider rsDefault">


                    </div>
                </div>
            {% endif %}
        </div>
        <br/>

        <div class="row">
            <div class="col-sm-3">
                <div id="accordion2" class="accordion">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <a href="#collapseOne" data-parent="#accordion2" data-toggle="collapse" class="accordion-toggle">
                                {{ "POPULAR_DESTINATIONS_HOME_TABS" | trans }}
                            </a>
                        </div>
                        <div class="accordion-body collapse in" id="collapseOne">
                            <div class="accordion-inner">
                                {% for destination in popular_list %}
                                    <a href="{{ path('frontend_details_destination',{'destination_name':popular_destinations_for_url[destination.des_id]}) }}">{{ destination['des_name'] }}</a><br/>

                                {% else %}
                                    <div class="alert a alert-info">{{ "EMPTY_LIST" | trans }}</div>
                                {% endfor %}
                                {% if popular_list |length %}
                                    <a class="fontsize_10" href="{{ path('frontend_list_destinations') }}">{{ "SEEMORE_LINK_TEXT" | trans }}</a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <a href="#collapseTwo" data-parent="#accordion2" data-toggle="collapse" class="accordion-toggle">
                                {{ "MORE_IN_DETAILS" | trans }} {{ location_municipality }}
                            </a>
                        </div>
                        <div class="accordion-body collapse" id="collapseTwo">
                            <div class="accordion-inner">
                                {% for destination in other_destinations_in_municipality %}
                                    <a href="{{ path('frontend_details_destination',{'destination_name':other_destinations_in_municipality_for_url[destination.desid]}) }}">{{ destination.desname }}</a><br/>

                                {% else %}
                                    <div class="alert a alert-info">{{ "EMPTY_LIST" | trans }}</div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <a href="#collapseThree" data-parent="#accordion2" data-toggle="collapse" class="accordion-toggle">
                                {{ "MORE_IN_DETAILS" | trans }} {{ location_province }}
                            </a>
                        </div>
                        <div class="accordion-body collapse" id="collapseThree">
                            <div class="accordion-inner">
                                {% for destination in other_destinations_in_province %}
                                    <a href="{{ path('frontend_details_destination',{'destination_name':other_destinations_in_province_for_url[destination.desid]}) }}">{{ destination.desname }}</a><br/>                        {% else %}
                                    <div class="alert a alert-info">{{ "EMPTY_LIST" | trans }}</div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <a href="#collapseFour" data-parent="#accordion2" data-toggle="collapse" class="accordion-toggle">
                                {{ "ALL_PROVINCES" | trans }}
                            </a>
                        </div>
                        <div class="accordion-body collapse" id="collapseFour">
                            <div class="accordion-inner">
                                {% for province in provinces %}
                                    <a href="{{ path('frontend_search_ownership',{'text':provinces_for_url[province.provid], 'arrival':'null','departure':'null','guests':'1', 'rooms':'1'}) }}">{{ province.provName }}</a><br/>
                                {% else %}
                                    <div class="alert a alert-info">{{ "EMPTY_LIST" | trans }}</div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                {{ include('FrontEndBundle:favorite:detailsFavorite.html.twig',
                {'is_in_favorite': is_in_favorite,
                    'favorite_type': 'destination',
                    'element_id':destination.desid
                }) }}
                <a href="#send_to_friend_popup" title="{{ 'SEND_TO_FRIEND' | trans }}" data-toggle="modal" style="text-decoration: none">
                    <button style="margin-top: 15px" class="btn btn-default btn-block" onclick="$('#send_to_friend_popup').attr('data-email-type', 'recommend_destiny'); $('#send_to_friend_popup').attr('data-dest-prop-id', '{{ destination.getDesId }}');">
                        <img src="{{ asset('bundles/frontend/img/main_to_friend.gif') }}" alt="{{ "TELL_A_FRIEND" | trans }}">{{ "TELL_A_FRIEND" | trans }}
                    </button>
                </a>
            </div>
            <div class="col-sm-9">
                <a name="#nearby"></a>
                {% if owns_nearby | length %}
                    <div id="loading" class="hidden">
                        <div class="layer-loading"></div>
                        <div class="loading-signal"><img class="img-circle load-icon" src="{{ asset('bundles/frontend/img/loading.gif') }}" alt="{{ "Loading" | trans }}"/></div>
                    </div>
                    <div class="bg-solid-blue-bar" style="margin-top: 0">
                        <div class="row">
                            <div class="col-xs-8">
                                <h1 class="h-white caecilia-roman">
                                    {{ 'WHERE_RENT_IN_DESTINATION' | trans ({'%destinationName%': desName}) }}
                                </h1>
                            </div>
                            <div class="col-xs-4 text-right">

                                {#<a id="change_view_to_list" href="#nearby" data-url="{{path('frontend_change_view_destination_callback', {'destination_name':desName,'destination_id': destination.desId})}}" rel="tooltip" data-placement="top" title="{{'LIST_VIEW' | trans}}"><img src="{{asset('bundles/frontend/img/icons/pixel.gif')}}" class="icon three-lines2-icon"></a>#}
                                <a id="change_view_to_photo" href="#nearby" data-url="{{ path('frontend_change_view_destination_callback', {'destination_name':desName,'destination_id': destination.desId}) }}" rel="tooltip" data-placement="top" title="{{ 'MOISAIC_VIEW' | trans }}"><img src="{{ asset('bundles/frontend/img/icons/pixel.gif') }}" class="icon cam-icon" alt="{{ "Pixel" | trans }}"></a>
                                <a id="change_view_to_map" href="#nearby" data-url="{{ path('frontend_change_view_destination_callback', {'destination_name':desName,'destination_id': destination.desId}) }}" rel="tooltip" data-placement="top" title="{{ 'MAP_VIEW' | trans }}"><img src="{{ asset('bundles/frontend/img/icons/pixel.gif') }}" class="icon point-icon" alt="{{ "Pixel" | trans }}"></a>

                            </div>
                        </div>
                    </div>
                    <div id="near_houses_container" class="houses-list" data-url="{{ path('frontend_nearby_destination',{'destination_name': destination.desname | lower | replace(" ", "-"),'destination_id': destination.desid }) }}">
                        {{ include('FrontEndBundle:destination:detailsOwnsNearByDestination.html.twig',
                        {'owns_nearby': owns_nearby,
                            'destination_name': destination.desname | lower | replace(" ", "-"),
                            'destination_id': destination.desid,
                            'data_view' : data_view }) }}
                    </div>
                {% endif %}
            </div>
        </div>
        <br/>
        {{ render(controller('FrontEndBundle:Public:homeCarrousel')) }}
    </div>
    {% block include_javascripts %}
        <script type="text/javascript">
            status = 0;
            $("#description_arrow").click(function () {
                layer_cont = $("#description_cont");
                shadow = $("#shadow_bottom");
                chevron = $("#description_arrow");
                if (status == 0) {
                    layer_cont.css('height', '100%');
                    layer_cont.css('overflowY', 'scroll');
                    shadow.css('height', '110px');
                    chevron.attr('class', 'icon-chevron-up')
                    status = 1;
                }
                else {
                    layer_cont.css('height', '54px');
                    layer_cont.css('overflowY', 'hidden');
                    shadow.css('height', '0');
                    chevron.attr('class', 'icon-chevron-down')
                    status = 0;

                }

            });
        </script>
        <script src="{{ global_google_maps_api_url_with_key }}" type="text/javascript"></script>
        <script type="text/javascript">
            jQuery(document).ready(function ($) {
                $('#full-width-slider').royalSlider({
                    numImagesToPreload: 5,
                    arrowsNav: true,
                    loop: false,
                    keyboardNavEnabled: true,
                    imageScaleMode: 'fill',
                    arrowsNavAutoHide: false,
                    autoScaleSlider: true,
                    autoScaleSliderWidth: 916,
                    autoScaleSliderHeight: 311,
                    controlNavigation: false,
                    thumbsFitInViewport: false,
                    navigateByClick: true,
                    startSlideId: 0,
                    autoPlay: false,
                    transitionType: 'move',
                    globalCaption: false,
                    deeplinking: {
                        enabled: true,
                        change: false
                    }
                });

                {% for photo in  gallery_photos%}
                var slider = $("#full-width-slider").data('royalSlider');
                var img = "{{asset('uploads/destinationImages/'~photo)}}";
                slider.appendSlide('<img class="rsImg" src="' + img + '" alt="" />');
                {%endfor%}
            });
        </script>
    {% endblock %}
{% endblock %}
