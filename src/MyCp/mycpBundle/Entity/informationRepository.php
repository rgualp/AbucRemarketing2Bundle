<?php

namespace MyCp\mycpBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * informationRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class informationRepository extends EntityRepository
{
    function new_information($post)
    {
        $em=$this->getEntityManager();
        $languages=$em->getRepository('mycpBundle:lang')->findAll();
        $information=new information();
        $information->setInfoFixed(0);
        $em->persist($information);

        foreach($languages as $language)
        {
            $information_lang= new informationLang();
            $information_lang->setInfoLangLang($language);
            $information_lang->setInfoLangContent($post['info_content_'.$language->getLangId()]);
            $information_lang->setInfoLangName($post['info_name_'.$language->getLangId()]);
            $information_lang->setInfoLangInfo($information);
            $em->persist($information_lang);
        }
        $em->flush();
    }

    function edit_information($post)
    {
        $em=$this->getEntityManager();
        $languages=$em->getRepository('mycpBundle:lang')->findAll();
        foreach($languages as $lang)
        {
            $information_lang=$em->getRepository('mycpBundle:informationLang')->findBy(array('info_lang_lang'=>$lang->getLangId()));
            $information_lang=$information_lang[0];
            $information_lang->setInfoLangName($post['info_name_'.$lang->getLangId()]);
            $information_lang->setInfoLangContent($post['info_content_'.$lang->getlangId()]);
            $em->persist($information_lang);

        }
        $em->flush();
    }
}
