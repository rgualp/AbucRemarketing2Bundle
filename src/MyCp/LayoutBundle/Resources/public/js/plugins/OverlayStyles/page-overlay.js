// Generated by CoffeeScript 1.4.0
(function($) {

    $.fn.pageOverlay = function(options) {

        var setting = $.extend({}, $.fn.pageOverlay.defaults, options);

        var overlay_container = null,
            triggerBttn = null,
            overlay = null,
            cont = 0;
            closeBttn = null;

        var transEndEventNames = {
            'WebkitTransition': 'webkitTransitionEnd',
            'MozTransition': 'transitionend',
            'OTransition': 'oTransitionEnd',
            'msTransition': 'MSTransitionEnd',
            'transition': 'transitionend'
        };

        var transEndEventName = transEndEventNames[ Modernizr.prefixed( 'transition' ) ],
            support = { transitions : Modernizr.csstransitions };

        this.each(function (e){
            overlay_container = document.querySelector( setting.content );
            triggerBttn = $(this);
            //overlay = $( $(this).attr("data-overlay"), document );
            overlay = document.querySelector( 'div'+$(this).attr("data-overlay") );

            closeBttn = $( 'button.overlay-close' , overlay);

            triggerBttn.on( 'click', function (s) {
                    /*----------------Register--------------------*/
                    if( classie.has( overlay, 'open' ) ) {
                        classie.remove( overlay, 'open' );
                        classie.remove( overlay_container, 'overlay-open' );
                        classie.add( overlay, 'close' );
                        var onEndTransitionFn = function( ev ) {
                            if( support.transitions ) {
                                if( ev.propertyName !== 'visibility' ) return;
                                this.removeEventListener( transEndEventName, onEndTransitionFn );
                            }
                            classie.remove( overlay, 'close' );
                        };
                        if( support.transitions ) {
                            overlay.addEventListener( transEndEventName, onEndTransitionFn );
                        }
                        else {
                            onEndTransitionFn();
                        }
                    }else if( !classie.has( overlay, 'close' ) ) {
                        classie.add( overlay, 'open' );
                        classie.add( overlay_container, 'overlay-open' );
                        $('#overlay-login').slimScroll({
                            height: '100%',
                            width: '100%',
                            railOpacity: 0.9,
                            color: '#0d3044',
                            opacity: 1,
                            alwaysVisible: true
                        });
                    }
            });

            closeBttn.on( 'click', function (s){
                /*----------------Register--------------------*/
                if( classie.has( overlay, 'open' ) ) {
                    classie.remove( overlay, 'open' );
                    classie.remove( overlay_container, 'overlay-open' );
                    classie.add( overlay, 'close' );
                    var onEndTransitionFn = function( ev ) {
                        if( support.transitions ) {
                            if( ev.propertyName !== 'visibility' ) return;
                            this.removeEventListener( transEndEventName, onEndTransitionFn );
                        }
                        classie.remove( overlay, 'close' );
                    };
                    if( support.transitions ) {
                        overlay.addEventListener( transEndEventName, onEndTransitionFn );
                    }
                    else {
                        onEndTransitionFn();
                    }
                }else if( !classie.has( overlay, 'close' ) ) {
                    classie.add( overlay, 'open' );
                    classie.add( overlay_container, 'overlay-open' );
                }
            });
            cont++;
        });



    };




    $.fn.pageOverlay.defaults = {
        content: "div.container"
    }

})(jQuery);